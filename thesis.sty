% ========================
% Thesis Package
% ========================
\ProvidesPackage{thesis}


% ========================
% Language and Encoding
% ========================
\usepackage[french,english]{babel}          % Multilingual support (French and English)
\usepackage[T1]{fontenc}                    % Use T1 font encoding (better hyphenation, accented characters)
%\usepackage[utf8]{inputenc}                % UTF-8 input encoding (redundant if using modern engines)


% ========================
% Typography and Layout
% ========================
\usepackage[a4paper,
            top=20mm,
            bottom=20mm,
            left=25mm,
            right=20mm,
            bindingoffset=5mm]{geometry}     % Page size and margins
\usepackage{setspace}                       % Line spacing commands
\onehalfspacing                             % 1.5 line spacing
\setlength{\parindent}{0cm}                 % No paragraph indentation
\setlength{\parskip}{6pt}                   % Space between paragraphs
\usepackage{times}                          % Use Times font (classic)
%\usepackage{newtxtext,newtxmath}           % Modern Times-like font alternative (commented)
\usepackage{xurl}                           % Allow line breaks inside URLs


% ========================
% Section Headings
% ========================
\usepackage{titlesec}                       % Custom formatting for section titles
\titleformat{\chapter}
  {\normalfont\bfseries\LARGE}{\thechapter.}{1em}{}     % Chapter format
\titleformat{\section}
  {\normalfont\bfseries\Large}{\thesection}{1em}{}      % Section format
\titleformat{\subsection}
  {\normalfont\bfseries\large}{\thesubsection}{1em}{}   % Subsection format
\titleformat{\subsubsection}
  {\normalfont\bfseries\normalsize}{\thesubsubsection}{1em}{}  % Subsubsection format
\titlespacing*{\chapter}{0pt}{20pt plus 2pt minus 2pt}{10pt}    % Spacing around chapters
\titlespacing*{\section}{0pt}{12pt plus 2pt minus 2pt}{6pt}     % Spacing around sections
\titlespacing*{\subsection}{0pt}{10pt plus 2pt minus 2pt}{4pt}  % Spacing around subsections
\titlespacing*{\subsubsection}{0pt}{8pt plus 2pt minus 2pt}{2pt}% Spacing around subsubsections


% ========================
% Table of Contents formatting
% ========================
\usepackage{tocloft}                          % Customize TOC, LOF, LOT formatting
\renewcommand{\cfttoctitlefont}{\hfill\Large\bfseries}   % Centered TOC title
\renewcommand{\cftaftertoctitle}{\hfill}                 % Centered TOC title
\setlength{\cftbeforetoctitleskip}{0em}                 % No extra space before TOC title
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}   % Dotted leaders for chapters
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}    % Dotted leaders for sections
%\usepackage{minitoc}                     % Mini table of contents for each chapter , conflicts with almost everything so disabled
\usepackage{titletoc}


% ========================
% Lists
% ========================
\usepackage{enumitem}                        % Fine control over list spacing and labels
\setlist[itemize]{noitemsep, topsep=0pt}     % Compact itemize lists
\setlist[enumerate]{noitemsep, topsep=0pt}   % Compact enumerate lists
\usepackage{longtable}                       % Tables spanning multiple pages
\usepackage{multirow}                        % Cells spanning multiple rows in tables
\setlength {\marginparwidth }{2cm}          % Margin width for todonotes
\usepackage{amssymb}                         % Additional math symbols
\renewcommand{\labelitemi}{\tiny$\blacksquare$}   % Black square bullets in itemize


% ========================
% Code
% ========================
\usepackage{listings}                        % Code listings
\usepackage{verbatimbox}                     % Centered verbatim environments


% ========================
% Bibliography
% ========================
\usepackage[sorting=none]{biblatex}          % Bibliography management , nyt for name , tear , title
\usepackage{csquotes}                        % Recommended with biblatex
\addbibresource{references.bib}              % BibTeX file location
\emergencystretch=1em                        % Helps avoid overfull lines in bibliography
\usepackage[final]{microtype}                % Better justification and kerning


% ========================
% Hyperlinks
% ========================
\usepackage[hidelinks]{hyperref}             % Clickable links without colored boxes


% ========================
% Notes
% ========================
\usepackage{todonotes}                       % To-do notes in margin
\setlength{\marginparwidth}{2cm}             % Margin width for todonotes


% ========================
% Headers and Footers
% ========================
\usepackage{fancyhdr}

\usepackage{fancyhdr}

% Front matter: minimal footer only
\fancypagestyle{frontmatter}{
  \fancyhf{}
  \fancyfoot[C]{\thepage}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}

% Main matter: header + footer + lines
\fancypagestyle{mainmatter}{
  \fancyhf{}
  \fancyhead[L]{\nouppercase{\leftmark}}
  \fancyfoot[R]{Page \thepage}
  \renewcommand{\headrulewidth}{0.4pt}
  \renewcommand{\footrulewidth}{0.4pt}
}

% Leave "plain" untouched so chapter first pages remain clean
\fancypagestyle{plain}{
  \fancyhf{}
  \fancyfoot[C]{\thepage}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}

% ========================
% Images and Figures
% ========================
\usepackage{graphicx}                        % Include images
\usepackage{wrapfig}                         % Wrap text around figures
\usepackage{caption}                         % Custom caption formatting
\captionsetup{labelsep=period}              % Use "." after "Figure 1"
\usepackage{float}                           % Force figure placement (e.g., [H])


% ========================
% Miscellaneous
% ========================
\usepackage{needspace}                       % Reserve space to prevent page breaks
\usepackage{hyphenat}                        % Advanced hyphenation options
\usepackage{blindtext}                       % Filler text for testing
\usepackage{chngcntr}                        % Change counter behavior
\counterwithout{table}{chapter}              % Continuous table numbering
\counterwithout{figure}{chapter}             % Continuous figure numbering
\usepackage{pdfpages}                        % Include PDFs
\usepackage{ifthen}                          % Conditional logic
\usepackage{datetime}                        % Date formatting
\renewcommand{\dateseparator}{-}             % Use "-" in dates (ISO style)


\sloppy                                      % Allow flexible line breaks to avoid overfull boxes
% ========================
% End of thesis package
% ========================